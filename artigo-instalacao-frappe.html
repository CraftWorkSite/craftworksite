<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Guia: Instalando o Frappe Framework no Windows com WSL - Craft Work Site</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="assets/css/style.css">
    <link rel="icon" href="https://lh3.googleusercontent.com/ogw/AF2bZygfOb3auLe8xuFEzGxH0yGap2nrQlTwDW0g8wvt5EHJSw=s32-c-mo">
</head>
<body>
    <header class="header">
        <h1>Craft Work Site</h1>
    </header>

    <nav class="nav">
        <ul>
            <li><a href="index.html#hero">Início</a></li>
            <li><a href="index.html#services">Serviços</a></li>
            <li><a href="blog.html">Blog</a></li>
            <li><a href="index.html#pricing">Preços</a></li>
            <li><a href="index.html#faq">FAQ</a></li>
            <li><a href="index.html#contact">Contato</a></li>
        </ul>
    </nav>
    
    <main>
        <div class="article-content">
            <a href="blog.html" class="back-link">&larr; Voltar para o Blog</a>
            <h1>Guia Definitivo: Instalando o Frappe Framework no Windows com WSL</h1>
    
            <h2>Passo 1: Habilitando o WSL e Instalando o Ubuntu 22.04</h2>
            <ol>
                <li>Abra o <strong>PowerShell</strong> como Administrador e instale o WSL com o Ubuntu:
                    <pre><code>wsl --install -d Ubuntu-22.04</code></pre>
                </li>
                <li>Reinicie o computador. O terminal do Ubuntu será aberto para que você crie seu usuário e senha padrão.</li>
            </ol>
    
            <h2>Passo 2: Criando um Usuário Dedicado 'frappe'</h2>
            <p>É uma boa prática não usar seu usuário principal ou `root`. Vamos criar um usuário `frappe` com privilégios de administrador.</p>
            <ol>
                <li>No terminal do Ubuntu, crie o novo usuário:
                    <pre><code>sudo adduser frappe</code></pre>
                </li>
                <li>Adicione o usuário ao grupo `sudo`:
                    <pre><code>sudo usermod -aG sudo frappe</code></pre>
                </li>
            </ol>
            <div class="note">
                <h3>Ponto Chave: Trabalhando como o Usuário `frappe`</h3>
                <p>Para evitar 99% dos erros de permissão, <strong>sempre</strong> troque para o usuário `frappe` antes de executar comandos do `bench`. Feche e abra um novo terminal, e execute:</p>
                <pre><code>su - frappe</code></pre>
                <p>O hífen (<code>-</code>) é crucial. Ele simula um login completo, carregando todas as configurações do usuário `frappe`.</p>
            </div>
    
            <h2>Passo 3: Instalação das Dependências Essenciais (Com Soluções)</h2>
            <p>Logado como usuário <strong>`frappe`</strong>, vamos instalar o que o Frappe precisa.</p>
            <ol>
                <li>Atualize o sistema:
                    <pre><code>sudo apt update && sudo apt upgrade -y</code></pre>
                </li>
                <li>Instale as dependências básicas:
                    <pre><code>sudo apt install -y git python3-dev python3-pip python3-venv mariadb-server redis-server</code></pre>
                </li>
                <li><strong>Configure o MariaDB:</strong> Defina a senha do usuário `root` do banco de dados.
                    <pre><code>sudo mariadb-secure-installation</code></pre>
                </li>
                <li><strong>Instale o Node.js via NVM (A Forma Correta e Definitiva):</strong>
                    <p>Usar o NVM (Node Version Manager) evita erros de permissão (`EACCES`) e garante a versão correta do Node (18+).</p>
                    <pre><code># Instala o NVM
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.7/install.sh | bash

# Carrega o NVM no terminal atual. Se 'nvm' não for encontrado, rode este comando!
source ~/.bashrc

# Instala o Node.js v18 e o define como padrão
nvm install 18
nvm alias default 18</code></pre>
                </li>
                <li><strong>Instale Yarn e o Frappe Bench:</strong>
                    <pre><code>npm install -g yarn
pip install frappe-bench</code></pre>
                </li>
            </ol>
    
            <h2>Passo 4: Conectando o VS Code ao WSL</h2>
            <p>Para um fluxo de trabalho ideal, veja nosso <a href="artigo-vscode-wsl.html">guia detalhado sobre como conectar o VS Code ao WSL</a>.</p>
    
            <h2>Passo 5: A Sequência Vencedora para Criar e Iniciar seu Site Frappe</h2>
            <p>Com o VS Code conectado, abra o terminal integrado (`Ctrl + ``). A seguir, a sequência de comandos que resolve os problemas mais comuns de uma instalação.</p>
            
            <h3>1. Crie a "Bench" (a pasta do projeto)</h3>
            <pre><code># Rode isso dentro da pasta /home/frappe
bench init frappe-bench
cd frappe-bench</code></pre>
    
            <h3>2. A Sequência de Reparo (se algo der errado)</h3>
            <p>Se você chegar a uma tela de erro no navegador, esta é a sequência para consertar um site quebrado ou com configuração dessincronizada.</p>
    
            <div class="note">
                <h4>A Lógica do Reparo</h4>
                <p>O erro mais comum é a configuração do site (<code>site_config.json</code>) não bater com as credenciais no banco de dados. A solução é apagar completamente o site problemático e recriá-lo do zero em seu ambiente agora estável.</p>
            </div>
            
            <ol>
                <li><strong>"Derrube" o site à força (`--force`):</strong>
                    <p>Este comando ignora erros de backup (como "Access Denied") e apaga o site quebrado.</p>
                    <pre><code>bench drop-site seu.site.local --force</code></pre>
                </li>
                <li><strong>Recrie o site do zero:</strong>
                    <p>Agora que o antigo foi removido, crie um novo e limpo.</p>
                    <pre><code>bench new-site seu.site.local</code></pre>
                    <em>Ele pedirá a senha do <strong>`root` do MariaDB</strong>. Depois, pedirá para você criar e confirmar a senha do usuário <strong>`Administrator`</strong>. Anote esta senha!</em>
                </li>
                <li><strong>Defina o site como padrão:</strong>
                    <p>Isso resolve o erro "Not Found" no navegador.</p>
                    <pre><code>bench use seu.site.local</code></pre>
                </li>
                <li><strong>Inicie o servidor:</strong>
                    <pre><code>bench start</code></pre>
                </li>
            </ol>
    
            <h3>3. Solução para "Address already in use"</h3>
            <div class="warning">
                <p>Se o <code>bench start</code> falhar com este erro, o serviço global do Redis está em conflito. Resolva com:</p>
                <pre><code># Pare e desabilite o serviço global do Redis
sudo systemctl stop redis-server
sudo systemctl disable redis-server

# Encerre processos "zumbis" que possam ter sobrado
sudo kill -9 $(sudo lsof -t -i:11000) $(sudo lsof -t -i:13000)</code></pre>
                <p>Após executar, tente o <code>bench start</code> novamente.</p>
            </div>
    
            <h2>Conclusão</h2>
            <p>Parabéns! Abra seu navegador no Windows e acesse <a href="http://localhost:8000" target="_blank">http://localhost:8000</a>. Faça o login com o usuário <strong>`Administrator`</strong> e a senha que você acabou de criar.</p>
            <p>Você concluiu a instalação de um ambiente de desenvolvimento robusto para o <strong>Frappe Framework</strong>. Agora você está pronto para o próximo passo: instalar aplicativos como o ERPNext!</p>
        </div>
    </main>

    <footer class="footer">
        <p>© 2024 Craft Work Site. Todos os direitos reservados.</p>
    </footer>
</body>
</html>
